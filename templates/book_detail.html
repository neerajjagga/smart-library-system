{% extends "base.html" %}

{% block title %}{{ book.title }} - Library System{% endblock %}

{% block extra_css %}
<style>
    .book-detail-container {
        display: grid;
        grid-template-columns: 250px 1fr;
        gap: 30px;
        margin-bottom: 40px;
    }
    
    .book-cover {
        background: linear-gradient(135deg, #6b7db3, #8694c9);
        border-radius: 8px;
        height: 350px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 14px;
        text-align: center;
        padding: 20px;
    }
    
    .book-actions {
        margin-top: 20px;
    }
    
    .book-actions button,
    .book-actions a,
    .book-actions .status {
        display: block;
        width: 100%;
        margin-bottom: 10px;
        padding: 12px;
        text-align: center;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
    }
    
    .book-actions .status {
        background-color: #d1ecf1;
        color: #0c5460;
    }
    
    .book-info h1 {
        font-size: 32px;
        margin-bottom: 20px;
    }
    
    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .info-item {
        padding: 15px;
        background: #f8f9fa;
        border-radius: 4px;
    }
    
    .info-item .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 5px;
    }
    
    .info-item .value {
        font-weight: bold;
        color: #333;
    }
    
    .section {
        margin-bottom: 30px;
    }
    
    .section h2 {
        font-size: 20px;
        margin-bottom: 15px;
        border-bottom: 2px solid #2c5aa0;
        padding-bottom: 10px;
    }
    
    .keyword-link {
        display: inline-block;
        background-color: #e8f0fe;
        color: #2c5aa0;
        padding: 6px 12px;
        border-radius: 4px;
        text-decoration: none;
        margin: 5px 5px 5px 0;
        font-size: 14px;
    }
    
    .keyword-link:hover {
        background-color: #d1e3f8;
    }
    
    .tag {
        display: inline-block;
        background-color: #d4edda;
        color: #155724;
        padding: 6px 12px;
        border-radius: 4px;
        margin: 5px 5px 5px 0;
        font-size: 14px;
    }
    
    .recommendations {
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .recommendations h2 {
        margin-bottom: 20px;
    }
    
    .rec-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
    }
    
    .rec-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        text-decoration: none;
        color: #333;
        border: 2px solid transparent;
        transition: all 0.2s;
    }
    
    .rec-card:hover {
        border-color: #2c5aa0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .rec-card h3 {
        color: #2c5aa0;
        margin-bottom: 10px;
        font-size: 16px;
    }
    
    .rec-card p {
        font-size: 13px;
        color: #666;
        margin: 5px 0;
    }
    
    @media (max-width: 768px) {
        .book-detail-container {
            grid-template-columns: 1fr;
        }
        
        .info-grid {
            grid-template-columns: 1fr;
        }
        
        .rec-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}

<div class="card">
    <div class="book-detail-container">
        <!-- Book Cover -->
        <div>
            <div class="book-cover">
                <p>Book Cover<br>{{ book.title }}</p>
            </div>
            
            <!-- Actions -->
            <div class="book-actions">
                {% if book.available_copies > 0 and not currently_borrowed %}
                <form action="/borrow/{{ book.book_id }}" method="post">
                    <button type="submit" class="btn btn-success">Borrow Book</button>
                </form>
                {% elif currently_borrowed %}
                <div class="status">Currently Borrowed</div>
                {% else %}
                <div class="status" style="background-color: #f8d7da; color: #721c24;">Not Available</div>
                {% endif %}
                
                <a href="/search?q={{ book.genre }}" class="btn btn-primary">Browse {{ book.genre }}</a>
            </div>
        </div>
        
        <!-- Book Information -->
        <div class="book-info">
            <h1>{{ book.title }}</h1>
            
            <div class="info-grid">
                <div class="info-item">
                    <div class="label">Author</div>
                    <div class="value">{{ book.author }}</div>
                </div>
                
                <div class="info-item">
                    <div class="label">Genre</div>
                    <div class="value">{{ book.genre }}</div>
                </div>
                
                {% if book.publication_year %}
                <div class="info-item">
                    <div class="label">Publication Year</div>
                    <div class="value">{{ book.publication_year }}</div>
                </div>
                {% endif %}
                
                {% if book.isbn %}
                <div class="info-item">
                    <div class="label">ISBN</div>
                    <div class="value">{{ book.isbn }}</div>
                </div>
                {% endif %}
                
                <div class="info-item">
                    <div class="label">Availability</div>
                    <div class="value" style="color: {% if book.available_copies > 0 %}#28a745{% else %}#dc3545{% endif %}">
                        {{ book.available_copies }}/{{ book.total_copies }} copies available
                    </div>
                </div>
            </div>
            
            {% if book.description %}
            <div class="section">
                <h2>Description</h2>
                <p style="line-height: 1.6;">{{ book.description }}</p>
            </div>
            {% endif %}
            
            {% if book.keywords %}
            <div class="section">
                <h2>Keywords</h2>
                <div>
                    {% for keyword in book.keywords.split(',') %}
                    <a href="/search?q={{ keyword.strip() }}" class="keyword-link">{{ keyword.strip() }}</a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            {% if book.tags %}
            <div class="section">
                <h2>Tags</h2>
                <div>
                    {% for tag in book.tags.split(',') %}
                    <span class="tag">{{ tag.strip() }}</span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Recommendations -->
{% if recommendations %}
<div class="recommendations">
    <h2>Similar Books</h2>
    <p style="color: #666; margin-bottom: 20px;">Books similar to "{{ book.title }}"</p>
    
    <div class="rec-grid">
        {% for rec_book in recommendations %}
        <a href="/book/{{ rec_book.book_id }}" class="rec-card">
            <h3>{{ rec_book.title }}</h3>
            <p>Author: {{ rec_book.author }}</p>
            <p>Genre: {{ rec_book.genre }}</p>
            {% if rec_book.description %}
            <p style="margin-top: 10px;">{{ rec_book.description[:100] }}{% if rec_book.description|length > 100 %}...{% endif %}</p>
            {% endif %}
            <p style="margin-top: 10px; font-weight: bold; color: {% if rec_book.available_copies > 0 %}#28a745{% else %}#dc3545{% endif %}">
                {{ rec_book.available_copies }} available
            </p>
        </a>
        {% endfor %}
    </div>
</div>
{% endif %}

{% endblock %}